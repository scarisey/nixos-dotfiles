# NixOS dotfiles


## Fresh install

```
nix-shell -p git
git clone https://github.com/scarisey/nixos-dotfiles.git
cd nixos-dotfiles
nix-shell ##the shell.nix file will activate flake feature
echo "trusted-users = root sylvain" | sudo tee -a /etc/nix/nix.conf && sudo pkill nix-daemon
sudo nixos-rebuild switch --flake .#hostname
nix run . -- switch --flake .
#OR
home-manager switch --flake .
```

## Default shell on other OS than Nixos

```
echo "$HOME/.nix-profile/bin/zsh" | sudo tee -a /etc/shells
chsh -s "$HOME/.nix-profile/bin/zsh"
```

## SOPS

### Generate key

```
mkdir -p ~/.config/sops/age
age-keygen -o ~/.config/sops/age/keys.txt
```

### Update sops

Add public key to .sops.yaml then update secrets.yaml with a computer that can already decrypt secrets.

```
sops updatekeys secrets.yaml
```
